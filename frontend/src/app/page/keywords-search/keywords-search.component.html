<div class="top-bar">
  <mat-form-field class="search-box" appearance="outline">
    <mat-label>Type</mat-label>
    <mat-select
      [(ngModel)]="actressNumberFilter"
      (ngModelChange)="onFilterChange($event)"
    >
      <mat-select-trigger>
        {{
          actressNumberFilter === "0"
            ? "All"
            : actressNumberFilter === "1"
            ? "Single"
            : actressNumberFilter === "2"
            ? "Sale"
            : "Type"
        }}
      </mat-select-trigger>
      <mat-option [value]="'0'">All</mat-option>
      <mat-option [value]="'1'">Single</mat-option>
      <mat-option [value]="'2'">Sale</mat-option>
    </mat-select>
  </mat-form-field>

  <!-- 分页按钮 -->
  <div class="pagination-controls" *ngIf="searchKeyWords.length != 0">
    <button
      mat-mini-fab
      color="primary"
      (click)="loadPreviousPage()"
      [disabled]="isLoading || this.page <= 1"
      aria-label="Previous Page"
    >
      <mat-icon>chevron_left</mat-icon>
    </button>

    <button
      mat-mini-fab
      color="primary"
      (click)="loadNextPage()"
      [disabled]="isLoading"
      aria-label="Next Page"
    >
      <mat-icon>chevron_right</mat-icon>
    </button>

    <div *ngIf="isLoading" class="loading-spinner">
      <mat-spinner diameter="24"></mat-spinner>
    </div>
  </div>
</div>

<div class="movie-container">
  <ng-container *ngFor="let movie of discoverResults">
    <ng-container *ngIf="shouldShowMovie(movie)">
      <div class="movie-card" (click)="onMovieClick(movie)">
        <img
          [src]="movie.img_url"
          alt="{{ movie.title }}"
          class="movie-img"
          (error)="onImageError($event)"
        />
        <div class="movie-info">
          <h3 class="movie-title">{{ movie.id }} - {{ movie.title }}</h3>
          <div class="movie-meta">
            <p class="movie-date">{{ movie.release_date }}</p>
            <div class="movie-tags">
              <span *ngFor="let tag of movie.actors?.slice(0, 3)" class="movie-tag">
                {{ tag }}
              </span>
              <span class="more-tags" *ngIf="(movie.actors?.length || 0) > 3">
                +{{ movie.actors!.length - 3 }}
              </span>
            </div>
          </div>
        </div>
      </div>
    </ng-container>
  </ng-container>
</div>

<div class="foot-bar">
  <!-- 分页按钮 -->
  <div class="pagination-controls-foot" *ngIf="searchKeyWords.length != 0">
    <button
      mat-mini-fab
      color="primary"
      (click)="loadPreviousPage()"
      [disabled]="isLoading || this.page <= 1"
      aria-label="Previous Page"
    >
      <mat-icon>chevron_left</mat-icon>
    </button>

    <button
      mat-mini-fab
      color="primary"
      (click)="loadNextPage()"
      [disabled]="isLoading"
      aria-label="Next Page"
    >
      <mat-icon>chevron_right</mat-icon>
    </button>

    <div *ngIf="isLoading" class="loading-spinner">
      <mat-spinner diameter="24"></mat-spinner>
    </div>
  </div>
</div>
